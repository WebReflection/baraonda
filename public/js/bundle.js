/*! (C) Andrea Giammarchi */
(function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<r.length;o++)i(r[o]);return i})({1:[function(e,t,n){t.exports=function(e){"use strict";function f(e,t,n,r,i){this.component=e,this.node=t,this.css=n,this.prefixes=r,this.doc=i}function l(e,t,n){return t+"-"+n.toLowerCase()}function c(e,t,n){var i=[],s=typeof t=="number"?"px":"",o=e.replace(r,l),u;for(u=0;u<n.length;u++)i.push("-",n[u],"-",o,":",t,s,";");return i.push(o,":",t,s,";"),i.join("")}function h(e,t){return e.length?e+"-"+t:t}function p(e,t,r,i){var s,u,a;for(s in r)if(n.call(r,s))if(typeof r[s]=="object")if(o(r[s])){u=r[s];for(a=0;a<u.length;a++)e.push(c(h(t,s),u[a],i))}else p(e,h(t,s),r[s],i);else e.push(c(h(t,s),r[s],i));return e.join("")}function d(e,t,r){var o=[],a,f,l,c,h,v,m,g,y,b;for(m in t)if(n.call(t,m)){a=m.charAt(0)==="@",v=a||!e.indexOf(m+" "),f=a&&s.test(m)?e:"",l=a&&!i.test(m),c=l?m.slice(1):m,g=u.concat(t[m]);for(y=0;y<g.length;y++){h=g[y];if(l){b=r.length;while(b--)o.push("@-",r[b],"-",c,"{",d(f,h,[r[b]]),"}");o.push(m,"{",d(f,h,r),"}")}else o.push(v?m:e+m,"{",p([],"",h,r),"}")}}return o.join("")}var t=e.toString,n=e.hasOwnProperty,r=/([a-z])([A-Z])/g,i=/^@(?:page|font-face)/,s=/^@(?:media)/,o=Array.isArray||function(e){return t.call(e)==="[object Array]"},u=[],a;return f.prototype={replace:function(e){e instanceof f||(e=a(this.component,e,this.prefixes,this.doc)),this.remove(),f.call(this,e.component,e.node,e.css,e.prefixes,e.doc)},remove:function(){var e=this.node,t=e.parentNode;t&&t.removeChild(e)},valueOf:function(){return this.css}},{"undefined":!0}[typeof document]?(a=function(e,t,n){return typeof e=="object"?(n=t,t=e,e=""):e+=" ",d(e,t,n||u)},a.restyle=a):a=function(e,t,n,r){typeof e=="object"?(r=n,n=t,t=e,i=e=""):i=e+" ";var i,s=r||(r=document),o=d(i,t,n||(n=a.prefixes)),u=s.head||s.getElementsByTagName("head")[0]||s.documentElement,l=u.insertBefore(s.createElement("style"),u.lastChild);return l.type="text/css",l.styleSheet?l.styleSheet.cssText=o:l.appendChild(s.createTextNode(o)),new f(e,l,o,n,r)},a.customElement=function(e,t,n){var r,i=Object.create(t.prototype);n&&n.css&&(n.css=a(e,n.css));for(r in n)i[r]=n[r];return document.registerElement(e,{prototype:i})},a.prefixes=["webkit","moz","ms","o"],a}({})},{}],2:[function(e,t,n){t.exports=function(e){var t,n,r,i,s;switch(!0){case!!e.AnimationEvent:n="animation",r="start",i="iteration",s="end";break;case!!e.WebKitAnimationEvent:n="webkitAnimation",r="Start",i="Iteration",s="End";break;case!!e.MSAnimationEvent:n="MSAnimation",r="Start",i="Iteration",s="End";break;case!!e.OAnimationEvent:n="oanimation",r="start",i="iteration",s="end";break;default:return n=[],s=function(e,n){t(e,n),n({type:"end",currentTarget:e})},t=function(e,t,r){if(arguments.length===3)n.push(e,t,setTimeout(s,r,e,t));else for(var i=0;i<n.length;i+=3)n[i]===e&&n[i+1]===t&&clearTimeout(n.splice(i,3)[2])},{on:function(n,r,i,s){return r==="end"?t(n,i,s):e.console&&e.console.warn("unsupported listener "+r),this},off:function(e,n,r){return n==="end"&&t(e,r),this}}}return t={start:n+r,iteration:n+i,end:n+s},{on:function(e,n,r,i){return e.addEventListener(t[n],r,!1),this},off:function(e,n,r){return e.removeEventListener(t[n],r,!1),this}}}(window)},{}],3:[function(e,t,n){var r=e("restyle");t.exports=function(){return{all:r({"*":{cursor:"default",touchAction:"none",userSelect:"none"}}),accuracy:r({"#accuracy":{width:0,marginLeft:0,transition:"all 3s"}}),glow:r({"@keyframes glow":{"0%":{boxShadow:"0px 0px 0px 0px rgba(255,255,255,1)"},"100%":{boxShadow:"0px 0px 32px 16px rgba(255,255,255,1)"}},".glow":{animation:{name:"glow",duration:"1s",iterationCount:"infinite",direction:"alternate"}}}),score:r({"#score":{lineHeight:score.offsetHeight,fontSize:Math.floor(score.offsetHeight/1.5)}}),circle:r({".circle":{position:"fixed",border:"2px solid #DDD",margin:{top:0,left:0},width:0,height:0,borderRadius:"50%"},".circle-showed":{width:100,height:100,margin:{top:-51,left:-51}},"@keyframes circle-showing":{"0%":{width:0,height:0,margin:{top:0,left:0}},"100%":{width:100,height:100,margin:{top:-51,left:-51}}},".circle-showing":{animation:{name:"circle-showing",duration:"250ms",iterationCount:"1",direction:"normal"}},"@keyframes circle-disappearing":{"0%":{opacity:"1",width:100,height:100,margin:{top:-51,left:-51}},"100%":{opacity:"0",width:0,height:0,margin:{top:0,left:0}}},".circle-disappearing":{animation:{name:"circle-disappearing",duration:"250ms",iterationCount:"1",direction:"normal"}},"@keyframes circle-growing":{"0%":{borderWidth:2,margin:{top:-51,left:-51},boxShadow:"0px 0px 0px 0px rgba(255,255,255,1)"},"100%":{borderWidth:32,margin:{top:-80,left:-80},boxShadow:"0px 0px 32px 16px rgba(255,255,255,1)"}},".circle-growing":{animation:{name:"circle-growing",duration:"500ms",iterationCount:"2",direction:"alternate"}},"@keyframes blue":{"0%":{backgroundColor:"#00A"},"100%":{backgroundColor:"#333"}},"body.blue":{animation:{name:"blue",duration:"350ms",iterationCount:"1",direction:"normal"}},"@keyframes red":{"0%":{backgroundColor:"#A00"},"100%":{backgroundColor:"#333"}},"body.red":{animation:{name:"red",duration:"350ms",iterationCount:"1",direction:"normal"}},"@keyframes blue-highlight":{"0%":{color:"#00F",opacity:"1"},"100%":{color:"#000",opacity:".3"}},".blue-highlight":{animation:{name:"blue-highlight",duration:"350ms",iterationCount:"1",direction:"normal"}},"@keyframes red-highlight":{"0%":{color:"#F00",opacity:"1"},"100%":{color:"#000",opacity:".3"}},".red-highlight":{animation:{name:"red-highlight",duration:"350ms",iterationCount:"1",direction:"normal"}},"@keyframes highlight":{"0%":{color:"#FFF",opacity:"1"},"100%":{color:"#000",opacity:".3"}},".highlight":{animation:{name:"highlight",duration:"900ms",iterationCount:"1",direction:"normal"}}})}}},{restyle:1}],4:[function(e,t,n){function r(e,t,n,r,i,s,o,u){var a=t<r,f=n<i,l=r+(a?-o:o),c=i+(f?-o:o),h=Math.random,p=Math.cos,d=Math.sin,v=Math.PI,m,g,y,b,w,E,S,x;while(u--){e.moveTo(S=t,x=n);do m=r-S,g=i-x,y=S+m/o,b=x+g/o,w=h()*2*v,E=h()*s,S=y+E*p(w),x=b+E*d(w),e.lineTo(S,x);while((a?S<l:l<S)||(f?x<c:c<x));e.lineTo(r,i)}}},{}],5:[function(e,t,n){function o(e){"use strict";function I(e,t){l.width=e,l.height=t}function q(){I(document.body.offsetWidth,document.body.offsetHeight),d.score.replace({"#score":{lineHeight:p.offsetHeight,fontSize:Math.floor(p.offsetHeight/1.5)}})}function R(e){e.currentTarget.className="",r.off(e.currentTarget,"end",R)}function U(){c.clearRect(0,0,l.width,l.height),D&&(c.beginPath(),0<D?s(c,l.width/2,0,j,F-50,c.lineWidth=2*D,10,3):s(c,j,F-50,l.width/2,-10,c.lineWidth=10,20,5),c.fillStyle=c.strokeStyle="rgb(221,221,221)",c.fill(),c.stroke(),c.closePath(),w(U))}function z(e){var t=e.acceleration;document.body.style.backgroundPosition=-e.gamma+"px "+ -e.beta+"px"}e.currentTarget.removeEventListener(e.type,o,!1);var t,n,u=!1,a="vibrate"in navigator?function(e){navigator.vibrate(e)}:Object,f=document.querySelector("#hi-score"),l=document.querySelector("#canvas"),c=l.getContext("2d"),h=document.querySelector("#details"),p=document.querySelector("#score"),d=i(),v=function(e){e.currentTarget.parentNode.removeChild(this),r.off(e.currentTarget,"end",v)},m=function(e){e.currentTarget.className="circle circle-showed glow",r.off(e.currentTarget,"end",m)},g=function(e){e.currentTarget.className="circle circle-showed glow",r.off(e.currentTarget,"end",g)},y=document.documentElement,b=navigator.pointerEnabled,w=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(e){window.setTimeout(e,40)},E=function(e){if(!e)return;r.on(e,"end",v,250),e.className="circle circle-disappearing"},S=function(e){n||(h.textContent="ready",N.emit("geolocation:coords",{latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy})),n=e.coords;var t=Math.min(n.accuracy,150),r=(document.body.offsetWidth-16)*t/150;d.accuracy.replace({"#accuracy":{width:r,marginLeft:-Math.round(r/2),transition:"all 3s"}})},x={enableHighAccuracy:!0,timeout:Infinity,maximumAge:0},T=navigator.geolocation.watchPosition(S,function(e){navigator.geolocation.clearWatch(T),x.enableHighAccuracy=!1,x.maximumAge=Infinity,T=navigator.geolocation.watchPosition(S,function(e){},x)},x),N=io(),C=function(e){return e.preventDefault(),e.stopPropagation(),e},k=function(e,n){E(t),t=document.body.appendChild(document.createElement("circle")),t.className="circle",t.style.cssText="".concat("top:",e,"px;","left:",n,"px;"),r.on(t,"end",g,250),t.className="circle circle-showing"},L=function(e){if(n){switch(C(e).type){case"mousedown":k(F=e.clientY,j=e.clientX);break;case"touchstart":if(e.touches.length>1)return;k(F=e.touches[0].clientY,j=e.touches[0].clientX);break;case"pointerdown":k(F=e.clientY,j=e.clientX),y.setPointerCapture(e.pointerId);break;case"MSPointerDown":k(F=e.clientY,j=e.clientX),y.msSetPointerCapture(e.pointerId)}u=!0,N.emit("geolocation:start",{latitude:n.latitude,longitude:n.longitude,accuracy:n.accuracy})}},A=function(e){var n;switch(C(e).type){case"touchmove":n=e.touches[0];break;default:n=e}t&&(t.style.top=(F=n.clientY)+"px",t.style.left=(j=n.clientX)+"px")},O=function(e){if(u){switch(C(e).type){case"touchend":if(e.touches.length)return;break;case"pointerdown":y.releasePointerCapture(e.pointerId);break;case"MSPointerDown":y.msReleasePointerCapture(e.pointerId)}E(t),t=null,N.emit("geolocation:end",{latitude:n.latitude,longitude:n.longitude,accuracy:n.accuracy})}},M=window.devicePixelRatio||1,_=0,D=0,P=0,H=!1,B,j,F;I(document.body.offsetWidth,document.body.offsetHeight),window.addEventListener("resize",q,!1),window.addEventListener("orientationchange",q,!1),window.addEventListener("deviceorientation",z,!1),y.addEventListener("contextmenu",C,!0),y.addEventListener("selectstart",C,!0),b||navigator.msPointerEnabled?(y.addEventListener(b?"pointerdown":"MSPointerDown",L,!0),y.addEventListener(b?"pointermove":"MSPointerMove",A,!0),y.addEventListener(b?"pointerup":"MSPointerUp",O,!0)):(y.addEventListener("touchstart",L,!0),y.addEventListener("touchmove",A,!0),y.addEventListener("touchend",O,!0),y.addEventListener("mousedown",L,!0),y.addEventListener("mousemove",A,!0),y.addEventListener("mouseup",O,!0)),h.textContent="collecting geolocation data",N.on("baraonda:created",function(e){H=!0,h.textContent=e?"collecting energy":"waiting",p.textContent=e||"",e!==_&&(a(100),r.on(document.body,"end",R,350),e>_?document.body.className="blue":document.body.className="red",_=e,D=e,D&&w(U))}),N.on("baraonda:joined",function(e){h.textContent="engaged",p.textContent=e,e!==_&&(e>_?(_||(r.on(h,"end",R,350),h.className="blue-highlight"),r.on(t,"end",m,500),t.className="circle circle-showed circle-growing"):(r.on(document.body,"end",R,350),document.body.className="red"),_=e),D||a(100),D=-1,w(U)}),N.on("baraonda:finished",function(e){h.textContent="mission completed",p.textContent=e,_=0,E(t),t=null,D=0,r.on(h,"end",R,350),h.className="blue-highlight",r.on(document.body,"end",R,350),document.body.className="blue",r.on(p,"end",R,900),p.className="highlight",a(250)}),N.on("baraonda:terminated",function(e){H=!1,h.textContent=e?"scored":"failed",p.textContent=e,_=0,D=0,r.on(p,"end",R,600),p.className="highlight",e&&(B={latitude:n.latitude,longitude:n.longitude,accuracy:n.accuracy,score:e,date:Date.now()},parseInt(localStorage.getItem("hi-score")||"0",10)<e?(localStorage.setItem("hi-score",e),localStorage.setItem("hi-score-details",JSON.stringify(B)),a(500),f.textContent=e,r.on(f,"end",R,900),f.className="highlight"):a(100))}),N.on("baraonda:left",function(e){h.textContent="revoked",p.textContent=e,_=0,D=0,r.on(h,"end",R,350),h.className="red-highlight",a(100)}),N.on("baraonda:somebody",function(e){!_&&H&&(h.textContent="watch out",r.on(h,"end",R,350),h.className="blue-highlight")}),N.on("baraonda:join",function(e){e&&!D&&(h.textContent="somebody is waiting",r.on(h,"end",R,350),h.className="blue-highlight")}),N.on("connect",function(e){h.textContent=n?"ready":"locating",r.on(h,"end",R,350),h.className="blue-highlight",_=0}),N.on("disconnect",function(e){h.textContent="limbo",p.textContent="?",_=0,D=0,r.on(h,"end",R,350),h.className="red-highlight"}),f.textContent=localStorage.getItem("hi-score")||""}var r=e("./animation"),i=e("./js-style"),s=e("./lightning");document.addEventListener("DOMContentLoaded",o,!1)},{"./animation":2,"./js-style":3,"./lightning":4}]},{},[5]);